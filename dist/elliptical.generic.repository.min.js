!function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e(require("elliptical-lodash").c):"function"==typeof define&&define.amd?define(["elliptical-lodash"],e):(t.elliptical=t.elliptical||{},t.elliptical.GenericRepository=e(t._.c),t.returnExports=t.elliptical.GenericRepository)}(this,function(t){function e(t,e,n){var r=(t-1)*e,i=t*e-1;return i>n&&(i=n),{start:r,end:i}}function n(t){return t.charAt(0).toLowerCase()+t.slice(1)}function r(t){return t.substring(0,t.length-1)}function i(t){var e=t[0],i=e.split("."),o=[];i.forEach(function(t){t=n(t),o.push(t)});var u="";return o.forEach(function(t){u+=t+"."}),u=r(u),[u]}function o(e,n){return t.filter(e,function(t,e){return e>=n.start&&e<=n.end})}function u(e,n){return t.find(e,function(t){return t.id.toString().toLowerCase()===n.toString().toLowerCase()})}function s(e,n){return t.findIndex(e,function(t){return t.id.toString().toLowerCase()===n.toString().toLowerCase()})}function a(e,n,r){return r&&(n=i(n)),t.sortByOrder(e,n,["asc"])}function l(e,n,r){return r&&(n=i(n)),t.sortByOrder(e,n,["desc"])}function c(t,e){var n=s(t,e);return t.splice(n,1),t}function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];c(t,r)}}function f(t,e,n){var r=u(t,e);for(var i in r)r.hasOwnProperty(i)&&void 0!==n[i]&&(r[i]=n[i])}function h(t,n){var r=arguments.length;if(0===r)throw"Generic Repository requires an array model passed in the constructor";"function"!=typeof n&&(n=null),this.model=t,this.callback=n,this.camelCaseSort=!0,this.get=function(t,e,n,r){e&&"object"==typeof e?(r=n,n=e):e&&"function"==typeof e&&(r=e,e=null);var i,o=this.model;return i=t&&t.id?u(o,t.id):n&&n.filter&&void 0!==n.filter?this.query(n.filter):o,n&&n.orderBy&&void 0!==n.orderBy&&(i=this.orderBy(i,n.orderBy)),n&&n.orderByDesc&&void 0!==n.orderByDesc&&(i=this.orderByDesc(i,n.orderByDesc)),n&&n.paginate&&(i=this.paginate(i,n.paginate)),this.callback?void this.callback(i,"get",t,r):r?r(null,i):i},this.post=function(t,e,n){var r=t;"string"!=typeof e&&(n=e);var i=this.model;return t.id=utils.guid(),i.push(t),this.onChange(i),this.callback?void this.callback(t,"post",r,n):n?n(null,t):t},this.put=function(t,e,n){"string"!=typeof e&&(n=e);var r=this.model;return f(r,t.id,t),this.onChange(r),this.callback?void this.callback(t,"put",t,n):n?n(null,t):t},this["delete"]=function(e,n,r){return"string"!=typeof n&&(r=n),e.id?c(t,e.id):e.ids&&d(t,e.ids),this.onChange(t),this.callback?void this.callback(null,"delete",e,r):r?r(null,null):null},this.Enumerable=function(){return Enumerable.From(this.model)},this.query=function(t,e){return this.model},this.onChange=function(t){},this.orderBy=function(t,e){var n=[];return n.push(e),a(t,n,this.camelCaseSort)},this.orderByDesc=function(t,e){var n=[];return n.push(e),l(t,n,this.camelCaseSort)},this.paginate=function(t,n){var r=t.length,i=n.pageSize,u=n.page;u||(u=1);var s=e(u,i,r),a=o(t,s);return{data:a,count:r}}}return void 0!==t.c&&(t=t.c),h});