!function(t,e){"undefined"!=typeof module&&module.exports?module.exports=e(require("elliptical-utils"),require("elliptical-lodash").c):"function"==typeof define&&define.amd?define(["elliptical-utils","elliptical-lodash"],e):(t.elliptical=t.elliptical||{},t.elliptical.GenericRepository=e(t.elliptical,t._.c),t.returnExports=t.elliptical.GenericRepository)}(this,function(t,e){function i(t,e,i){var n=(t-1)*e,r=t*e-1;return r>i&&(r=i),{start:n,end:r}}function n(t,i){return e.filter(t,function(t,e){return e>=i.start&&e<=i.end})}function r(t,i){return e.find(t,function(t){return t.id.toString().toLowerCase()===i.toString().toLowerCase()})}function o(t,i){return e.findIndex(t,function(t){return t.id.toString().toLowerCase()===i.toString().toLowerCase()})}function l(t,i){return e.sortByOrder(t,i,["asc"])}function u(t,i){return e.sortByOrder(t,i,["desc"])}function a(t,e){var i=o(t,e);return t.splice(i,1),t}function s(t,e){for(var i=0;i<e.length;i++){var n=e[i];a(t,n)}}function c(t,e,i){var n=r(t,e);for(var o in n)n.hasOwnProperty(o)&&void 0!==i[o]&&(n[o]=i[o])}function d(e,o){var d=arguments.length;if(0===d)throw"Generic Repository requires an array model passed in the constructor";"function"!=typeof o&&(o=null),this.model=e,this.callback=o,this.get=function(t,e,i,n){e&&"object"==typeof e?(n=i,i=e):e&&"function"==typeof e&&(n=e,e=null);var o,l=this.model;return o=t&&t.id?r(l,t.id):i&&i.filter&&void 0!==i.filter?this.query(i.filter):l,i&&i.orderBy&&void 0!==i.orderBy&&(o=this.orderBy(o,i.orderBy)),i&&i.orderByDesc&&void 0!==i.orderByDesc&&(o=this.orderByDesc(o,i.orderByDesc)),i&&i.paginate&&(o=this.paginate(o,i.paginate)),this.callback?void this.callback(o,"get",t,n):n?n(null,o):o},this.post=function(e,i,n){var r=e;"string"!=typeof i&&(n=i);var o=this.model;return e.id=t.guid(),o.push(e),this.onChange(o),this.callback?void this.callback(e,"post",r,n):n?n(null,e):e},this.put=function(t,e,i){"string"!=typeof e&&(i=e);var n=this.model;return c(n,t.id,t),this.onChange(n),this.callback?void this.callback(t,"put",t,i):i?i(null,t):t},this["delete"]=function(t,i,n){return"string"!=typeof i&&(n=i),t.id?a(e,t.id):t.ids&&s(e,t.ids),this.onChange(e),this.callback?void this.callback(null,"delete",t,n):n?n(null,null):null},this.Enumerable=function(){return Enumerable.From(this.model)},this.query=function(t,e){return this.model},this.onChange=function(t){},this.orderBy=function(t,e){var i=[];return i.push(e),l(t,i)},this.orderByDesc=function(t,e){var i=[];return i.push(e),u(t,i)},this.paginate=function(t,e){var r=t.length,o=e.pageSize,l=e.page;l||(l=1);var u=i(l,o,r),a=n(t,u);return{data:a,count:r}}}return void 0!==e.c&&(e=e.c),d});