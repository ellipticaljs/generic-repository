!function(t,r){"undefined"!=typeof module&&module.exports?module.exports=r(require("elliptical-lodash").c):"function"==typeof define&&define.amd?define(["elliptical-lodash"],r):(t.elliptical=t.elliptical||{},t.elliptical.GenericRepository=r(t._.c),t.returnExports=t.elliptical.GenericRepository)}(this,function(t){function r(t,r,e){var n=(t-1)*r,i=t*r-1;return i>e&&(i=e),{start:n,end:i}}function e(){var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function n(t){return t.charAt(0).toLowerCase()+t.slice(1)}function i(t){return t.substring(0,t.length-1)}function o(t){var r=t[0],e=r.split("."),o=[];e.forEach(function(t){t=n(t),o.push(t)});var a="";return o.forEach(function(t){a+=t+"."}),a=i(a),[a]}function a(r,e){return t.filter(r,function(t,r){return r>=e.start&&r<=e.end})}function s(r,e){return t.find(r,function(t){return t.id.toString().toLowerCase()===e.toString().toLowerCase()})}function u(r,e){return t.findIndex(r,function(t){return t.id.toString().toLowerCase()===e.toString().toLowerCase()})}function c(r,e,n){return n&&(e=o(e)),t.sortByOrder(r,e,["asc"])}function l(r,e,n){return n&&(e=o(e)),t.sortByOrder(r,e,["desc"])}function d(t,r){var e=u(t,r);return t.splice(e,1),t}function h(t,r){for(var e=0;e<r.length;e++){var n=r[e];d(t,n)}}function f(t,r,e){var n=s(t,r);for(var i in n)n.hasOwnProperty(i)&&void 0!==e[i]&&(n[i]=e[i])}function p(t,n){var i=arguments.length;if(0===i)throw"Generic Repository requires an array model passed in the constructor";"function"!=typeof n&&(n=null),this.model=t,this.callback=n,this.camelCaseSort=!0,this.get=function(t,r,e,n){r&&"object"==typeof r?(n=e,e=r):r&&"function"==typeof r&&(n=r,r=null);var i,o=this.model;return i=t&&t.id?s(o,t.id):e&&e.filter&&void 0!==e.filter?this.query(e.filter):o,e&&e.orderBy&&void 0!==e.orderBy&&(i=this.orderBy(i,e.orderBy)),e&&e.orderByDesc&&void 0!==e.orderByDesc&&(i=this.orderByDesc(i,e.orderByDesc)),e&&e.paginate&&(i=this.paginate(i,e.paginate)),this.callback?void this.callback(i,"get",t,n):n?n(null,i):i},this.post=function(t,r,n){var i=t;"string"!=typeof r&&(n=r);var o=this.model;return t.id=e(),o.push(t),this.onChange(o),this.callback?void this.callback(t,"post",i,n):n?n(null,t):t},this.put=function(t,r,e){"string"!=typeof r&&(e=r);var n=this.model;return f(n,t.id,t),this.onChange(n),this.callback?void this.callback(t,"put",t,e):e?e(null,t):t},this["delete"]=function(r,e,n){return"string"!=typeof e&&(n=e),r.id?d(t,r.id):r.ids&&h(t,r.ids),this.onChange(t),this.callback?void this.callback(null,"delete",r,n):n?n(null,null):null},this.Enumerable=function(){return Enumerable.From(this.model)},this.query=function(t,r){return this.model},this.onChange=function(t){},this.orderBy=function(t,r){var e=[];return e.push(r),c(t,e,this.camelCaseSort)},this.orderByDesc=function(t,r){var e=[];return e.push(r),l(t,e,this.camelCaseSort)},this.paginate=function(t,e){var n=t.length,i=e.pageSize,o=e.page;o||(o=1);var s=r(o,i,n),u=a(t,s);return{data:u,count:n}},this._get=function(t,r,e){var n,i=this.model;return n=r&&r.filter&&void 0!==r.filter?this.query(r.filter):i,r&&r.orderBy&&void 0!==r.orderBy&&(n=this.orderBy(n,r.orderBy)),r&&r.orderByDesc&&void 0!==r.orderByDesc&&(n=this.orderByDesc(n,r.orderByDesc)),r&&r.paginate&&(n=this.paginate(n,r.paginate)),this.callback?void this.callback(n,"get",t,e):e?e(null,n):n}}return void 0!==t.c&&(t=t.c),p});