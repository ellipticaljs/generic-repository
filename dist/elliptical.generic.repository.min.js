!function(t,i){"undefined"!=typeof module&&module.exports?module.exports=i(require("elliptical-utils"),require("elliptical-lodash").c):"function"==typeof define&&define.amd?define(["elliptical-utils","elliptical-lodash"],i):(t.elliptical=t.elliptical||{},t.elliptical.GenericRepository=i(t.elliptical,t._.c),t.returnExports=t.elliptical.GenericRepository)}(this,function(t,i){function e(t,i,e){var r=(t-1)*i,n=t*i-1;return n>e&&(n=e),{start:r,end:n}}function r(t,e){return i.filter(t,function(t,i){return i>=e.start&&i<=e.end})}function n(t,e){return i.find(t,function(t){return t.id.toString()===e.toString()})}function o(t,e){return i.findIndex(t,function(t){return t.id.toString()===e.toString()})}function l(t,e){return i.sortByOrder(t,e,["asc"])}function u(t,e){return i.sortByOrder(t,e,["desc"])}function c(t,i){var e=o(t,i);return t.splice(e,1),t}function a(t,i){for(var e=0;e<i.length;e++){var r=i[e];c(t,r)}}function s(t,i,e){var r=n(t,i);for(var o in r)r.hasOwnProperty(o)&&void 0!==e[o]&&(r[o]=e[o])}function d(i,o){var d=arguments.length;if(0===d)throw"Generic Repository requires an array model passed in the constructor";"function"!=typeof o&&(o=null),this.model=i,this.callback=o,this.get=function(t,i,e,r){i&&"object"==typeof i?(r=e,e=i):i&&"function"==typeof i&&(r=i,i=null);var o,l=this.model;return o=t&&t.id?n(l,t.id):e&&e.filter&&void 0!==e.filter?this.query(e.filter):l,e&&e.orderBy&&void 0!==e.orderBy&&(o=this.orderBy(o,e.orderBy)),e&&e.orderByDesc&&void 0!==e.orderByDesc&&(o=this.orderByDesc(o,e.orderByDesc)),e&&e.paginate&&(o=this.paginate(o,e.paginate)),this.callback?void this.callback(o,"get",t,r):r?r(null,o):o},this.post=function(i,e,r){var n=i;"string"!=typeof e&&(r=e);var o=this.model;return i.id=t.guid(),o.push(i),this.callback?void this.callback(i,"post",n,r):r?r(null,i):i},this.put=function(t,i,e){"string"!=typeof i&&(e=i);var r=this.model;return s(r,t.id,t),this.callback?void this.callback(t,"put",t,e):e?e(null,t):t},this["delete"]=function(t,e,r){return"string"!=typeof e&&(r=e),t.id?c(i,t.id):t.ids&&a(i,t.ids),this.callback?void this.callback(null,"delete",t,r):r?r(null,null):null},this.Enumerable=function(){return Enumerable.From(this.model)},this.query=function(t,i){return this.model},this.orderBy=function(t,i){var e=[];return e.push(i),l(t,e)},this.orderByDesc=function(t,i){var e=[];return e.push(i),u(t,e)},this.paginate=function(t,i){var n=t.length,o=i.pageSize,l=i.page,u=e(l,o,n),c=r(t,u);return{data:c,count:n}}}return void 0!==i.c&&(i=i.c),d});