!function(t,n){"undefined"!=typeof module&&module.exports?module.exports=n(require("elliptical-lodash").c):"function"==typeof define&&define.amd?define(["elliptical-lodash"],n):(t.elliptical=t.elliptical||{},t.elliptical.GenericRepository=n(t._.c),t.returnExports=t.elliptical.GenericRepository)}(this,function(t){function n(t,n,r){var e=(t-1)*n,i=t*n-1;return i>r&&(i=r),{start:e,end:i}}function r(){var t=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}function e(t){return t.charAt(0).toLowerCase()+t.slice(1)}function i(t){return t.substring(0,t.length-1)}function o(t){var n=t[0],r=n.split("."),o=[];r.forEach(function(t){t=e(t),o.push(t)});var u="";return o.forEach(function(t){u+=t+"."}),u=i(u),[u]}function u(n,r){return t.filter(n,function(t,n){return n>=r.start&&n<=r.end})}function a(n,r){return t.find(n,function(t){return t.id.toString().toLowerCase()===r.toString().toLowerCase()})}function s(n,r){return t.findIndex(n,function(t){return t.id.toString().toLowerCase()===r.toString().toLowerCase()})}function c(n,r,e){return e&&(r=o(r)),t.sortByOrder(n,r,["asc"])}function l(n,r,e){return e&&(r=o(r)),t.sortByOrder(n,r,["desc"])}function d(t,n){var r=s(t,n);return t.splice(r,1),t}function f(t,n){for(var r=0;r<n.length;r++){var e=n[r];d(t,e)}}function h(t,n,r){var e=a(t,n);for(var i in e)e.hasOwnProperty(i)&&void 0!==r[i]&&(e[i]=r[i])}function p(t,e){var i=arguments.length;if(0===i)throw"Generic Repository requires an array model passed in the constructor";"function"!=typeof e&&(e=null),this.model=t,this.callback=e,this.camelCaseSort=!0,this.get=function(t,n,r,e){n&&"object"==typeof n?(e=r,r=n):n&&"function"==typeof n&&(e=n,n=null);var i,o=this.model;return i=t&&t.id?a(o,t.id):r&&r.filter&&void 0!==r.filter?this.query(r.filter):o,r&&r.orderBy&&void 0!==r.orderBy&&(i=this.orderBy(i,r.orderBy)),r&&r.orderByDesc&&void 0!==r.orderByDesc&&(i=this.orderByDesc(i,r.orderByDesc)),r&&r.paginate&&(i=this.paginate(i,r.paginate)),this.callback?void this.callback(i,"get",t,e):e?e(null,i):i},this.post=function(t,n,e){var i=t;"string"!=typeof n&&(e=n);var o=this.model;return t.id=r(),o.push(t),this.onChange(o),this.callback?void this.callback(t,"post",i,e):e?e(null,t):t},this.put=function(t,n,r){"string"!=typeof n&&(r=n);var e=this.model;return h(e,t.id,t),this.onChange(e),this.callback?void this.callback(t,"put",t,r):r?r(null,t):t},this["delete"]=function(n,r,e){return"string"!=typeof r&&(e=r),n.id?d(t,n.id):n.ids&&f(t,n.ids),this.onChange(t),this.callback?void this.callback(null,"delete",n,e):e?e(null,null):null},this.Enumerable=function(){return Enumerable.From(this.model)},this.query=function(t,n){return this.model},this.onChange=function(t){},this.orderBy=function(t,n){var r=[];return r.push(n),c(t,r,this.camelCaseSort)},this.orderByDesc=function(t,n){var r=[];return r.push(n),l(t,r,this.camelCaseSort)},this.paginate=function(t,r){var e=t.length,i=r.pageSize,o=r.page;o||(o=1);var a=n(o,i,e),s=u(t,a);return{data:s,count:e}}}return void 0!==t.c&&(t=t.c),p});